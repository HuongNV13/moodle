{"version":3,"sources":["../src/calendar_popover.js"],"names":["blockNode","initPopover","dates","forEach","date","dateEle","popover","content","source","next","length","temptContent","find","clone","html","enablePopover","disablePopover","isPopoverAvailable","document","querySelector","contains","init","instanceId","querySelectorAll","addEventListener","eventTypes","blockMoved","e","detail"],"mappings":"sMAyBA,OACA,O,sDAGIA,CAAAA,CAAS,CAAG,I,CAMVC,CAAW,CAAG,SAACC,CAAD,CAAW,CAC3BA,CAAK,CAACC,OAAN,CAAc,SAACC,CAAD,CAAU,CACpB,GAAIC,CAAAA,CAAO,CAAG,cAAOD,CAAP,CAAd,CACAC,CAAO,CAACC,OAAR,CAAgB,CACZC,OAAO,CAAE,UAAW,IACZC,CAAAA,CAAM,CAAGH,CAAO,CAACI,IAAR,CAAa,kCAAb,CADG,CAEZF,CAAO,CAAG,cAAO,OAAP,CAFE,CAGhB,GAAIC,CAAM,CAACE,MAAX,CAAmB,CACf,GAAIC,CAAAA,CAAY,CAAGH,CAAM,CAACI,IAAP,CAAY,SAAZ,EAAuBC,KAAvB,IAAnB,CACAN,CAAO,CAACO,IAAR,CAAaH,CAAY,CAACG,IAAb,EAAb,CACH,CACD,MAAOP,CAAAA,CAAO,CAACO,IAAR,EACV,CATW,CAAhB,CAWH,CAbD,CAcH,C,CAMKC,CAAa,CAAG,SAACb,CAAD,CAAW,CAC7BA,CAAK,CAACC,OAAN,CAAc,SAACC,CAAD,CAAU,CACpB,GAAIC,CAAAA,CAAO,CAAG,cAAOD,CAAP,CAAd,CACAC,CAAO,CAACC,OAAR,CAAgB,QAAhB,CACH,CAHD,CAIH,C,CAMKU,CAAc,CAAG,SAACd,CAAD,CAAW,CAC9BA,CAAK,CAACC,OAAN,CAAc,SAACC,CAAD,CAAU,CACpB,GAAIC,CAAAA,CAAO,CAAG,cAAOD,CAAP,CAAd,CACAC,CAAO,CAACC,OAAR,CAAgB,SAAhB,CACH,CAHD,CAIH,C,CAEKW,CAAkB,CAAG,UAAM,CAC7B,MAAOC,CAAAA,QAAQ,CAACC,aAAT,CAAuB,iCAAvB,EAAwDC,QAAxD,CAAiEpB,CAAjE,CACV,C,CAOYqB,CAAI,CAAG,SAACC,CAAD,CAAgB,CAChCtB,CAAS,CAAGkB,QAAQ,CAACC,aAAT,CAAuB,uBAAwBG,CAAxB,CAAqC,KAA5D,CAAZ,CACA,GAAMpB,CAAAA,CAAK,CAAGF,CAAS,CAACuB,gBAAV,CAA2B,6CAA3B,CAAd,CACAtB,CAAW,CAACC,CAAD,CAAX,CACA,GAAI,CAACe,CAAkB,EAAvB,CAA2B,CACvBD,CAAc,CAACd,CAAD,CACjB,CAEDgB,QAAQ,CAACM,gBAAT,CAA0BC,aAAWC,UAArC,CAAiD,SAASC,CAAT,CAAY,CACzD,GAAIA,CAAC,CAACC,MAAF,CAASN,UAAT,GAAwBA,CAA5B,CAAwC,CACpC,GAAIL,CAAkB,EAAtB,CAA0B,CACtBF,CAAa,CAACb,CAAD,CAChB,CAFD,IAEO,CACHc,CAAc,CAACd,CAAD,CACjB,CACJ,CACJ,CARD,CASH,C","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript popover for the `core_calendar` subsystem.\n *\n * @module core_calendar/calendar_popover\n * @copyright 2021 Huong Nguyen <huongnv13@gmail.com>\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since 4.0\n */\n\n// eslint-disable-next-line no-unused-vars\nimport Popover from 'theme_boost/popover';\nimport jQuery from 'jquery';\nimport {eventTypes} from 'core_block/events';\n\nlet blockNode = null;\n\n/**\n * Init the popover init for calendar date.\n * @param {NodeList} dates List of date element to enable\n */\nconst initPopover = (dates) => {\n    dates.forEach((date) => {\n        let dateEle = jQuery(date);\n        dateEle.popover({\n            content: function() {\n                let source = dateEle.next('div[data-region=\"day-content\"]');\n                let content = jQuery('<div>');\n                if (source.length) {\n                    let temptContent = source.find('.hidden').clone(false);\n                    content.html(temptContent.html());\n                }\n                return content.html();\n            }\n        });\n    });\n};\n\n/**\n * Enable the popover for calendar date.\n * @param {NodeList} dates List of date element to enable\n */\nconst enablePopover = (dates) => {\n    dates.forEach((date) => {\n        let dateEle = jQuery(date);\n        dateEle.popover('enable');\n    });\n};\n\n/**\n * Disable the popover for calendar date.\n * @param {NodeList} dates List of date element to enable\n */\nconst disablePopover = (dates) => {\n    dates.forEach((date) => {\n        let dateEle = jQuery(date);\n        dateEle.popover('disable');\n    });\n};\n\nconst isPopoverAvailable = () => {\n    return document.querySelector('[data-region=\"blocks-column\"]').contains(blockNode);\n};\n\n/**\n * Initialises popover.\n *\n * @param {String} instanceId Form element\n */\nexport const init = (instanceId) => {\n    blockNode = document.querySelector('[data-instance-id=\"' + instanceId + '\"]');\n    const dates = blockNode.querySelectorAll('.d-md-block [data-action=\"view-day-link\"]');\n    initPopover(dates);\n    if (!isPopoverAvailable()) {\n        disablePopover(dates);\n    }\n\n    document.addEventListener(eventTypes.blockMoved, function(e) {\n        if (e.detail.instanceId === instanceId) {\n            if (isPopoverAvailable()) {\n                enablePopover(dates);\n            } else {\n                disablePopover(dates);\n            }\n        }\n    });\n};\n"],"file":"calendar_popover.min.js"}